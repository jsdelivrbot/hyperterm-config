{"version":3,"sources":["../../../src/lib/getCommands/updates.js"],"names":["gitDateToISOString","gitDate","repoPromise","local","remote","dirs","repo","fetch","checkout","log","err","hash","latest","date","then","resolve","isAfter"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEA,IAAMA,qBAAqB,SAArBA,kBAAqB;AAAA,SAAW,sBAAOC,OAAP,EAAgB,uBAAhB,CAAX;AAAA,CAA3B;;;wEAEe;AAAA,QAASC,WAAT,SAASA,WAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,iBADO,GACC,EADD;AAEPC,kBAFO,GAEE,EAFF;AAAA;AAAA,mBAIPF,WAJO;;AAAA;AAAA;AAAA,mBAKP,sBACJ;AAAA,qBACE,yBAAU,iBAAMG,IAAN,CAAWC,IAArB,EACGC,KADH,GAEGC,QAFH,CAEY,eAFZ,EAGGC,GAHH,CAGO,CAAC,IAAD,EAAO,GAAP,EAAY,YAAZ,CAHP,EAGkC,UAACC,GAAD,EAAMD,GAAN,EAAc;AAC5CL,uBAAOO,IAAP,GAAcF,IAAIG,MAAJ,CAAWD,IAAzB;AACAP,uBAAOS,IAAP,GAAcb,mBAAmBS,IAAIG,MAAJ,CAAWC,IAA9B,CAAd;AACD,eANH,EAOGL,QAPH,CAOY,QAPZ,EAQGC,GARH,CAQO,CAAC,IAAD,EAAO,GAAP,EAAY,YAAZ,CARP,EAQkC,UAACC,GAAD,EAAMD,GAAN,EAAc;AAC5CN,sBAAMQ,IAAN,GAAaF,IAAIG,MAAJ,CAAWD,IAAxB;AACAR,sBAAMU,IAAN,GAAab,mBAAmBS,IAAIG,MAAJ,CAAWC,IAA9B,CAAb;AACD,eAXH,EAYGC,IAZH,CAYQC,OAZR,CADF;AAAA,aADI,CALO;;AAAA;AAAA,6CAwBX,sBAAOX,OAAOS,IAAd,EAAoBG,OAApB,CAA4Bb,MAAMU,IAAlC,KACAV,MAAMQ,IAAN,KAAeP,OAAOO,IAzBX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","file":"updates.js","sourcesContent":["import moment from 'moment';\nimport simpleGit from 'simple-git';\nimport { paths } from '../../constants';\n\nconst gitDateToISOString = gitDate => moment(gitDate, 'YYYY-MM-DD HH:mm:ss Z');\n\nexport default async ({ repoPromise }) => {\n  const local = {};\n  const remote = {};\n\n  await repoPromise;\n  await new Promise(\n    resolve => (\n      simpleGit(paths.dirs.repo)\n        .fetch()\n        .checkout('origin/master')\n        .log(['-n', '1', '--date=iso'], (err, log) => {\n          remote.hash = log.latest.hash;\n          remote.date = gitDateToISOString(log.latest.date);\n        })\n        .checkout('master')\n        .log(['-n', '1', '--date=iso'], (err, log) => {\n          local.hash = log.latest.hash;\n          local.date = gitDateToISOString(log.latest.date);\n        })\n        .then(resolve)\n    ),\n  );\n\n  return (\n    moment(remote.date).isAfter(local.date) &&\n    local.hash !== remote.hash\n  );\n};\n"]}